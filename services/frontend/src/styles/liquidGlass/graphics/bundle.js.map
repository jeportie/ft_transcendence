{
  "version": 3,
  "sources": ["../src/styles/liquidGlass/lib/motion.ts", "../src/styles/liquidGlass/lib/magnifyingDisplacement.ts", "../src/styles/liquidGlass/lib/imageDataToUrl.ts", "../src/styles/liquidGlass/lib/filterGenerator.ts", "../src/styles/liquidGlass/graphics/magnifyingGlass.ts"],
  "sourcesContent": ["// ************************************************************************** //\n//                                                                            //\n//                                                        :::      ::::::::   //\n//   motion.ts                                          :+:      :+:    :+:   //\n//                                                    +:+ +:+         +:+     //\n//   By: jeportie <jeportie@42.fr>                  +#+  +:+       +#+        //\n//                                                +#+#+#+#+#+   +#+           //\n//   Created: 2025/10/24 11:55:08 by jeportie          #+#    #+#             //\n//   Updated: 2025/10/24 11:59:02 by jeportie         ###   ########.fr       //\n//                                                                            //\n// ************************************************************************** //\n\nexport type Subscriber<T> = (value: T) => void;\n\nexport class MotionValue<T> {\n    private _value: T;\n    private subscribers: Subscriber<T>[] = [];\n\n    constructor(initial: T) {\n        this._value = initial;\n    }\n\n    get(): T {\n        return this._value;\n    }\n\n    set(v: T): void {\n        this._value = v;\n        this.subscribers.forEach((fn) => fn(v));\n    }\n\n    onChange(fn: Subscriber<T>): () => void {\n        this.subscribers.push(fn);\n        fn(this._value);\n        return () => {\n            this.subscribers = this.subscribers.filter((f) => f !== fn);\n        };\n    }\n}\n\n/** Derived reactive value */\nexport function useTransform<A, B>(\n    source: MotionValue<A>,\n    transform: (v: A) => B\n): MotionValue<B> {\n    const mv = new MotionValue(transform(source.get()));\n    source.onChange((v) => mv.set(transform(v)));\n    return mv;\n}\n\n/** Spring interpolation (basic physics) */\nexport function useSpring(\n    source: MotionValue<number>,\n    opts: { stiffness: number; damping: number }\n): MotionValue<number> {\n    const mv = new MotionValue(source.get());\n    let vel = 0;\n    const dt = 1 / 60;\n\n    const update = () => {\n        const target = source.get();\n        const x = mv.get();\n        const fSpring = opts.stiffness * (target - x);\n        const fDamp = opts.damping * vel;\n        const a = (fSpring - fDamp);\n        vel += a * dt;\n        mv.set(x + vel * dt);\n        requestAnimationFrame(update);\n    };\n    update();\n    source.onChange(() => { }); // keep alive\n    return mv;\n}\n\n", "// ************************************************************************** //\n//                                                                            //\n//                                                        :::      ::::::::   //\n//   magnifyingDisplacement.ts                          :+:      :+:    :+:   //\n//                                                    +:+ +:+         +:+     //\n//   By: jeportie <jeportie@42.fr>                  +#+  +:+       +#+        //\n//                                                +#+#+#+#+#+   +#+           //\n//   Created: 2025/10/24 11:51:55 by jeportie          #+#    #+#             //\n//   Updated: 2025/10/24 12:59:10 by jeportie         ###   ########.fr       //\n//                                                                            //\n// ************************************************************************** //\n\nexport function createImageDataBrowser(width: number, height: number): ImageData {\n    const canvas = document.createElement(\"canvas\");\n    const ctx = canvas.getContext(\"2d\");\n    if (!ctx) throw new Error(\"Failed to get 2D context\");\n    return ctx.createImageData(width, height);\n}\n\nexport function calculateMagnifyingDisplacementMap(canvasWidth: number, canvasHeight: number): ImageData {\n    const dpr = window.devicePixelRatio ?? 1;\n    const bufferWidth = Math.floor(canvasWidth * dpr);\n    const bufferHeight = Math.floor(canvasHeight * dpr);\n    const imageData = createImageDataBrowser(bufferWidth, bufferHeight);\n\n    const ratio = Math.max(bufferWidth / 2, bufferHeight / 2);\n\n    for (let y = 0; y < bufferHeight; y++) {\n        for (let x = 0; x < bufferWidth; x++) {\n            const idx = (y * bufferWidth + x) * 4;\n\n            const rX = (x - bufferWidth / 2) / ratio;\n            const rY = (y - bufferHeight / 2) / ratio;\n\n            imageData.data[idx] = 128 - rX * 127;      // R\n            imageData.data[idx + 1] = 128 - rY * 127;  // G\n            imageData.data[idx + 2] = 0;               // B\n            imageData.data[idx + 3] = 255;             // A\n        }\n    }\n    return imageData;\n}\n\n", "// ************************************************************************** //\n//                                                                            //\n//                                                        :::      ::::::::   //\n//   imageDataToUrl.ts                                  :+:      :+:    :+:   //\n//                                                    +:+ +:+         +:+     //\n//   By: jeportie <jeportie@42.fr>                  +#+  +:+       +#+        //\n//                                                +#+#+#+#+#+   +#+           //\n//   Created: 2025/10/24 11:51:38 by jeportie          #+#    #+#             //\n//   Updated: 2025/10/24 12:58:43 by jeportie         ###   ########.fr       //\n//                                                                            //\n// ************************************************************************** //\n\nexport function imageDataToUrl(imageData: ImageData): string {\n    const canvas = document.createElement(\"canvas\");\n    canvas.width = imageData.width;\n    canvas.height = imageData.height;\n    const ctx = canvas.getContext(\"2d\");\n    if (!ctx) throw new Error(\"Failed to get 2D context\");\n    ctx.putImageData(imageData, 0, 0);\n    return canvas.toDataURL();\n}\n\n", "// ************************************************************************** //\n//                                                                            //\n//                                                        :::      ::::::::   //\n//   filterGenerator.ts                                 :+:      :+:    :+:   //\n//                                                    +:+ +:+         +:+     //\n//   By: jeportie <jeportie@42.fr>                  +#+  +:+       +#+        //\n//                                                +#+#+#+#+#+   +#+           //\n//   Created: 2025/10/24 12:52:40 by jeportie          #+#    #+#             //\n//   Updated: 2025/10/24 13:00:46 by jeportie         ###   ########.fr       //\n//                                                                            //\n// ************************************************************************** //\n\nimport { calculateMagnifyingDisplacementMap } from \"./magnifyingDisplacement\";\nimport { imageDataToUrl } from \"./imageDataToUrl\";\n\nexport function createMagnifyingFilter(id = \"magnifying-glass-filter\", width = 210, height = 150) {\n    const imageData = calculateMagnifyingDisplacementMap(width, height);\n    const dataUrl = imageDataToUrl(imageData);\n\n    const svg = document.createElementNS(\"http://www.w3.org/2000/svg\", \"svg\");\n    svg.style.display = \"none\";\n    const defs = document.createElementNS(\"http://www.w3.org/2000/svg\", \"defs\");\n    const filter = document.createElementNS(\"http://www.w3.org/2000/svg\", \"filter\");\n    filter.setAttribute(\"id\", id);\n\n    const feImage = document.createElementNS(\"http://www.w3.org/2000/svg\", \"feImage\");\n    feImage.setAttribute(\"href\", dataUrl);\n    feImage.setAttribute(\"result\", \"magnifying_displacement_map\");\n    feImage.setAttribute(\"x\", \"0\");\n    feImage.setAttribute(\"y\", \"0\");\n    feImage.setAttribute(\"width\", width.toString());\n    feImage.setAttribute(\"height\", height.toString());\n    filter.appendChild(feImage);\n\n    const feDisplace = document.createElementNS(\"http://www.w3.org/2000/svg\", \"feDisplacementMap\");\n    feDisplace.setAttribute(\"in\", \"SourceGraphic\");\n    feDisplace.setAttribute(\"in2\", \"magnifying_displacement_map\");\n    feDisplace.setAttribute(\"scale\", \"24\");\n    feDisplace.setAttribute(\"xChannelSelector\", \"R\");\n    feDisplace.setAttribute(\"yChannelSelector\", \"G\");\n    filter.appendChild(feDisplace);\n\n    defs.appendChild(filter);\n    svg.appendChild(defs);\n    document.body.appendChild(svg);\n\n    return `url(#${id})`;\n}\n\n", "// ************************************************************************** //\n//                                                                            //\n//                                                        :::      ::::::::   //\n//   magnifyingGlass.ts                                 :+:      :+:    :+:   //\n//                                                    +:+ +:+         +:+     //\n//   By: jeportie <jeportie@42.fr>                  +#+  +:+       +#+        //\n//                                                +#+#+#+#+#+   +#+           //\n//   Created: 2025/10/24 11:59:33 by jeportie          #+#    #+#             //\n//   Updated: 2025/10/24 12:55:22 by jeportie         ###   ########.fr       //\n//                                                                            //\n// ************************************************************************** //\n\nimport { MotionValue, useSpring, useTransform } from \"../lib/motion\";\nimport { createMagnifyingFilter } from \"../lib/filterGenerator\"; // \u2705 add filter generator\n\nexport function setupMagnifyingGlass(root: HTMLElement) {\n    // --- DOM\n    const lens = root.querySelector<HTMLDivElement>(\".lens\");\n    const img = root.querySelector<HTMLImageElement>(\".background\");\n\n    // Optional inputs (for demos)\n    const inputs = {\n        specularOpacity: root.querySelector<HTMLInputElement>(\"#specularOpacity\"),\n        specularSaturation: root.querySelector<HTMLInputElement>(\"#specularSaturation\"),\n        refractionBase: root.querySelector<HTMLInputElement>(\"#refractionBase\"),\n    };\n\n    // --- Early guards\n    if (!lens) {\n        console.warn(\"[LiquidGlass] No .lens element found\");\n        return;\n    }\n\n    // --- \uD83D\uDD39 Create the SVG filter dynamically\n    const filterUrl = createMagnifyingFilter(\"magnifying-glass-filter\", 210, 150);\n    lens.style.backdropFilter = filterUrl;\n    lens.style.webkitBackdropFilter = filterUrl; // Safari support\n\n    // --- Motion values\n    const isDragging = new MotionValue(false);\n    const velocityX = new MotionValue(0);\n\n    const specularOpacity = new MotionValue(\n        inputs.specularOpacity ? parseFloat(inputs.specularOpacity.value) : 0.5\n    );\n    const specularSaturation = new MotionValue(\n        inputs.specularSaturation ? parseFloat(inputs.specularSaturation.value) : 9\n    );\n    const refractionBase = new MotionValue(\n        inputs.refractionBase ? parseFloat(inputs.refractionBase.value) : 1\n    );\n\n    // --- Springs and transforms\n    const dragMultiplier = useTransform(isDragging, d => (d ? 1 : 0.8));\n    const refractionLevel = useSpring(\n        useTransform(refractionBase, v => v * dragMultiplier.get()),\n        { stiffness: 250, damping: 14 }\n    );\n    const magnifyingScale = useSpring(\n        useTransform(isDragging, d => (d ? 48 : 24)),\n        { stiffness: 250, damping: 14 }\n    );\n    const objectScale = useSpring(\n        useTransform(isDragging, d => (d ? 1 : 0.8)),\n        { stiffness: 340, damping: 20 }\n    );\n    const shadowAlpha = useSpring(\n        useTransform(isDragging, d => (d ? 0.22 : 0.16)),\n        { stiffness: 220, damping: 24 }\n    );\n\n    // --- Interactions\n    let offsetX = 0, offsetY = 0;\n    let drag = false;\n\n    lens.addEventListener(\"mousedown\", (e) => {\n        drag = true;\n        isDragging.set(true);\n        offsetX = e.offsetX;\n        offsetY = e.offsetY;\n        lens.style.cursor = \"grabbing\";\n    });\n\n    window.addEventListener(\"mouseup\", () => {\n        drag = false;\n        isDragging.set(false);\n        lens.style.cursor = \"grab\";\n    });\n\n    window.addEventListener(\"mousemove\", (e) => {\n        if (!drag) return;\n        const rect = root.getBoundingClientRect();\n        const x = e.clientX - rect.left - offsetX;\n        const y = e.clientY - rect.top - offsetY;\n        lens.style.left = `${x}px`;\n        lens.style.top = `${y}px`;\n    });\n\n    // --- Reactive rendering loop\n    const render = () => {\n        lens.style.transform = `scale(${objectScale.get()})`;\n        lens.style.boxShadow = `0 4px 24px rgba(0,0,0,${shadowAlpha.get()})`;\n        requestAnimationFrame(render);\n    };\n    render();\n\n    // --- Input bindings\n    if (inputs.specularOpacity) {\n        inputs.specularOpacity.addEventListener(\"input\", e =>\n            specularOpacity.set(parseFloat((e.target as HTMLInputElement).value))\n        );\n    }\n    if (inputs.specularSaturation) {\n        inputs.specularSaturation.addEventListener(\"input\", e =>\n            specularSaturation.set(parseFloat((e.target as HTMLInputElement).value))\n        );\n    }\n    if (inputs.refractionBase) {\n        inputs.refractionBase.addEventListener(\"input\", e =>\n            refractionBase.set(parseFloat((e.target as HTMLInputElement).value))\n        );\n    }\n}\n\n"],
  "mappings": "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",
  "names": []
}
